<HTML>
<HEAD><TITLE> OPEN_API 통화내역</TITLE>
<SCRIPT type="text/javascript" language="JavaScript" src="api_js.js"></script>

<SCRIPT FOR="KTOpenAPIX" EVENT="EventLogin(nResult)" LANGUAGE="Jscript">
/**
	로그인 관련 이벤트
**/ 
	if(nResult==200)
	{
		alert( "[Event] Login 성공" );		
	}
	else
	{
		alert( "[Event] Login 실패" );
	}
 
</SCRIPT>


<SCRIPT FOR="KTOpenAPIX" EVENT="EventConnect(nResult)" LANGUAGE="Jscript">
/**
	Connect 이벤트
**/ 
	var oDiv = document.all("DivConnect");
	if(nResult==1){
		oDiv.innerText="성공";
	}else{
		oDiv.innerText="실패";
	}
</SCRIPT>


<SCRIPT FOR="KTOpenAPIX" EVENT="EventChangePasswd( sPasswd )" LANGUAGE="Jscript">
/**
 패스워드 변경 통지 이벤트
**/
alert( "패스워드 변경 : " + sPasswd );
</SCRIPT>


<SCRIPT FOR="KTOpenAPIX" EVENT="EventSyncAddressData( nMode, sAdType, sAdParentSeqno, sAdSeqno, sAdName, sAdMNumber, sAdONumber, sAdHNumber, sAdFNumber, sAdCompany, sAdTeam, sAdTitle, sAdBusiness, sAdZipCode, sAdAddress, sAdEmail, sAdMemo, sAdBirthDay, sAdBirthType, sNgName, sAdMetChance, sAdKeyman, sAdFavorite)" LANGUAGE="Jscript">

/**
 주소록 사용자 통지 이벤트

**/
  var EventSyncAddressData = "";
  EventSyncAddressData = 
    "모드:"     + nMode   +" "+
    
    ", 주소:"    + sAdAddress  +" "+
    ", 생년월일:"   + sAdBirthDay  +" "+
    ", 음력0,양력1:"  + sAdBirthType +" "+
    ", 담당업무:"   + sAdBusiness  +" "+
    ", 회사이름:"   + sAdCompany  +" "+
    ", 이메일주소:"   + sAdEmail  +" "+
    ", 관심사:"    + sAdFavorite  +"\n"+
    ", 팩스번호:"   + sAdFNumber  +" "+
    ", 집전화번호:"   + sAdHNumber  +" "+
    ", 추천인:"    + sAdKeyman  +" "+
    ", 인물메모:"   + sAdMemo   +" "+
    ", 만난상황:"   + sAdMetChance +" "+
    ", 핸드폰번호:"   + sAdMNumber  +" "+
    ", 이름:"    + sAdName   +" "+
    ", 회사전화번호:"  + sAdONumber  +"\n"+
    ", 상위그룹일련번호:" + sAdParentSeqno +" "+
    ", 주소록일련번호:"  + sAdSeqno  +" "+
    ", 부서:"    + sAdTeam   +" "+
    ", 직책:"    + sAdTitle  +" "+
    ", 그룹타입:"   + sAdType   +" "+
    ", 우편번호:"   + sAdZipCode  +" "+
    ", 인맥:"    + sNgName   +"\n\n";

document.getElementById("EventSyncAddressData").value =EventSyncAddressData;


</SCRIPT>

<SCRIPT FOR="KTOpenAPIX" EVENT="EventAddinCall( nSelectType, sAddinType, nCount)" LANGUAGE="Jscript">

/**
	브라우져 콜 이벤트

**/
	var EventAddinCall = "";

		EventAddinCall =	"선택한메뉴타입:"		+	nMode			+" "+
				", 사용한프로그램:"		+	sAgName			+" "+
				", 전화번호 수:"		+	sAgParentSeqno	+"\n";
	
		document.getElementById("EventAddinCall").value =EventAddinCall;
</SCRIPT>

</HEAD>

<BODY>
<OBJECT ID="KTOpenAPIX" CLASSID="CLSID:16AB1B2A-A22E-4FAC-92CB-84102DF5CE3D"></OBJECT>
	<table border="1" width ="1450px">
		<tr>
			<td>접속확인</td>
		</tr>
		<tr>
			<td><div id="DivConnect">&nbsp;</div></td>  
		</tr>
		<tr>
			<td>
				<table border="1" style="float:left"  >
					<tr>
						<td >로그인 </td>
						<td><input type ="button" value ="강제로그아웃" onclick ="LoginKickOut()"></td>
					</tr>
					<tr>
						<td width="70">서버</td>
						<td>
							<select Name="server" >
							<option value="0" >개발용</option>
							<option value="1">상용</option>
							</select>
							<input type="button" value="회선청약" onclick="LineJoin()">
						</td>
					</tr>
					<tr>
						<td>인증키</td>
						<td> <Input Type = "Text" Name = "authkey"value = "인증키 입력"  onclick = "keyclear()"></td>
					</tr>
					<tr>
						<td>아이디</td>
						<td><Input Type = "Text" Name = "loginID"value = "아이디 입력" onclick = "idclear()"></td>
					</tr>
					<tr>
						<td>비밀번호</td>
						<td><Input Type = "password" Name = "loginPWD"value = "비밀번호" onclick = "passclear()"></td>
					</tr>
					<tr>
						<td colspan="2">
						<input type="button" value='로그인' onClick="Login()"> 
						<input type="button" value='로그아웃' onClick="Logout()">
						<input type="button" value='도움말' onClick="HelpEX()">
						</td>
					</tr>
					<tr>
						<td colspan="2">
						<input type="button" value='회원가입' onClick="UserJoinEX()">
						<input type="button" value='비밀번호 찾기' onClick="FindPasswdEX()">
						</td>
					</tr>
				</table>
				<table border ="1px" style="float:left">
					<tr>
						<td>전화번호 세팅</td>
					</tr>
					<tr>
						<td><input type = "text" name ="sRecvPhone" ></td>
					</tr>
					<tr>
						<td><input type = "button" value="전화번호 세팅" onclick="SetRecvPhone()"><input type = "button" value="가져오기" onclick="GetRecvPhone()"></td>
					</tr>
					<tr>
						<td><input type = "button" value="전화번호 삭제" onclick="RemoveRecvPhone()"><input type = "button" value="전체삭제" onclick="RemoveAllRecvPhone()"></td>
					</tr>
					<tr>
						<td><textarea id="RecvPhonelist" cols ="30" rows = "5"></textarea></td>
					</tr>	
				</table>
				<table border = "1px">
					<tr>
						<td>주소록 사용자 통지</td>
					</tr>
					<tr>
						<td><textarea id="EventSyncAddressData" style="width:900px" rows = "4"></textarea></td>
					</tr>
					<tr>
						<td>브라우져 콜</td>
					</tr>
					<tr>
						<td><textarea id="EventSyncAddressData" style="width:900px" rows = "4"></textarea></td>
					</tr>
				</table>
			</td>
		</tr>
		<tr>
			<td>
				<table border ="1px">
					<tr>
						<td>통화내역</td>
					</tr>
					<tr>
						<td>
							<input type = "button" value="부재중리스트" onclick="GetAbsenceCallList()">
							통화내역 종류 : 
							<select name = "sKind">
							<option value="1">ALL</option>
							<option value="2">발신</option>
							<option value="3">수신</option>
							<option value="4">부재중</option>
							<option value="5">실패</option>
							<option value="6">예약전송</option>
							<option value="7">핸드폰</option>
							</select>
							통화내역시작번호 : <input type ="text" name ="nStart" size = "3" value="0">
							가져올통화내역수 : <input type ="text" name ="nCount" size = "3"value="20">
							<input type = "button" value="통화 내역 수" onclick="GetCallCount()">
							<input type = "button" value="통화내역 리스트" onclick="GetCallList()">
							통화내역 일련번호 : <input type ="text" name ="CallsDBID" size = "5">
							<input type = "button" value = "통화내역" onclick="GetCall()">
							<input type = "button" value = "내역삭제" onclick="DelCall()">
						</td>
					</tr>
					<tr>
						<td><textarea id="GetAbsenceCallList" cols ="200" rows= "10"></textarea></td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
</BODY>
</HTML>

